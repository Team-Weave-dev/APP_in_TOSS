# 제품 요구사항 정의서 (PRD)
# Roulette for Group Meals

> **프로젝트**: ROULETTE
> **버전**: 1.0
> **작성일**: 2025-10-24
> **관련 문서**: [CLAUDE.md](../CLAUDE.md) | [기술 사양서](TECHNICAL_SPEC.md) | [개발 가이드](DEVELOPMENT_GUIDE.md)

---

## 문서 개요

이 문서는 ROULETTE 프로젝트의 제품 요구사항을 정의합니다.

**목적**: 단체 식사 메뉴 선택을 돕는 룰렛 앱 + GPS 기반 맛집 추천 + 길안내

**플랫폼**: Apps in Toss (WebView)

---

## 0. 목표 및 범위

### 🎯 목표 (Goal)

1. **룰렛 기능**
   - 테마(회식/데이트/배달/술집) 선택
   - 균등 확률로 메뉴 추첨
   - 공정한 무작위 선택 보장

2. **GPS 기반 맛집 검색**
   - 사용자 현재 위치 기반
   - 주변 맛집 검색 및 목록 표시
   - 지도에 위치 표시

3. **길안내 제공**
   - 카카오 길찾기 링크 제공
   - 앱 연동 (설치 시 앱 열기)

4. **안정적인 WebView 통합**
   - 앱인토스 WebView로 안정적 로딩
   - 딥링크 진입 지원

### ❌ 비목표 (Non-Goal)

다음 기능은 현재 범위에 포함되지 않습니다:

- ❌ 회원/로그인 시스템
- ❌ 결제 기능
- ❌ 소셜 기능 (후기, 좋아요, 댓글)
- ❌ 고급 개인화 추천 (AI 기반)
- ❌ 콜드스타트 문제 해결

---

## 1. 사용자 시나리오

### 시나리오 1: 회식 메뉴 선택

```
1. 사용자가 앱을 열고 "회식" 테마 선택
2. 룰렛을 돌림 (스핀 버튼 클릭)
3. "삼겹살"이 선택됨 (햅틱 피드백)
4. 결과 화면에서 "주변 삼겹살집 찾기" 클릭
5. GPS 권한 허용
6. 주변 삼겹살집 목록 및 지도 표시
7. 원하는 가게 선택 후 "길안내" 클릭
8. 카카오맵으로 길안내 시작
```

### 시나리오 2: 데이트 장소 추천

```
1. "데이트" 테마 선택
2. 룰렛 결과: "파스타"
3. 주변 이탈리안 레스토랑 검색
4. 지도에서 가게 위치 확인
5. 가게 정보 확인 (주소, 전화번호)
6. 길안내 또는 결과 공유
```

### 시나리오 3: 배달 메뉴 선택

```
1. "배달" 테마 선택
2. 룰렛 결과: "치킨"
3. 결과 확인
4. 다시 돌리기 또는 결과 공유
```

---

## 2. 주요 기능

### 2.1 테마 선택

**설명**: 사용자가 상황에 맞는 테마를 선택합니다.

**테마 목록**:
- 🍖 **회식**: 삼겹살, 곱창, 중화요리, 호프집, 전골, 한정식
- 💑 **데이트**: 파스타, 스시, 브런치, 이자카야, 이탈리안, 퓨전
- 🍕 **배달**: 치킨, 피자, 버거, 분식, 한식, 중식
- 🍺 **술집**: 와인바, 칵테일, 펍, 참이슬, 하이볼, 맥주집

**UI 요구사항**:
- 4개 타일로 구성
- 각 테마별 아이콘 및 짧은 설명
- 클릭 시 룰렛 화면으로 전환

### 2.2 룰렛 기능

**설명**: 선택된 테마의 메뉴 항목 중 하나를 무작위로 선택합니다.

**요구사항**:
- ✅ 균등 확률 보장 (각 항목 1/N 확률)
- ✅ 공정한 난수 생성 (`crypto.getRandomValues`)
- ✅ 시각적 스핀 애니메이션
- ✅ 햅틱 피드백 (진동)
- ✅ 결과 토스트 표시

**UI 요구사항**:
- 룰렛 휠 시각화
- 하단 고정 "스핀" 버튼
- 스핀 중 버튼 비활성화
- 결과 후 "결과 보기" 버튼

### 2.3 GPS 기반 맛집 검색

**설명**: 룰렛 결과를 기반으로 주변 맛집을 검색합니다.

**요구사항**:
- ✅ 사용자 위치 권한 요청
- ✅ 현재 위치 기반 검색 (반경 1.5km 기본)
- ✅ Kakao Local API 연동
- ✅ 검색 결과 목록 및 지도 표시

**검색 로직**:
- 룰렛 결과를 키워드로 사용
- 예: "삼겹살" → Kakao Local `query=삼겹살`
- 카테고리 코드 활용 (FD6=음식점)

**UI 요구사항**:
- 상단: 검색 결과 키워드 표시
- 중앙: 지도 또는 목록 토글
- 하단: 가게 목록 (스크롤 가능)
- 우측 상단: 반경 필터 (500m/1km/1.5km/2km)

### 2.4 지도 표시

**설명**: Kakao Maps로 검색 결과를 지도에 표시합니다.

**요구사항**:
- ✅ Kakao Maps JS SDK 연동
- ✅ 현재 위치 마커 표시
- ✅ 가게 위치 마커 표시
- ✅ 마커 클릭 시 인포윈도우 (가게명, 주소)
- ✅ 줌/팬 기능

### 2.5 길안내

**설명**: 선택한 가게까지의 길안내를 제공합니다.

**요구사항**:
- ✅ 카카오 길찾기 링크 생성
- ✅ 앱 설치 시 카카오맵 앱 열기
- ✅ 미설치 시 웹 길찾기

**구현**:
```
웹 링크: https://map.kakao.com/link/to/{가게명},{lat},{lng}
```

### 2.6 공유 기능 (선택)

**설명**: 룰렛 결과를 공유합니다.

**요구사항**:
- Apps in Toss `share()` API 사용
- 텍스트 공유: "오늘 저녁은 {결과}!"
- 링크 공유: 딥링크 포함

---

## 3. 사용자 플로우

### 3.1 메인 플로우

```
[홈 화면]
    ↓ 테마 선택
[룰렛 화면]
    ↓ 스핀
[결과 화면]
    ↓ 주변 찾기
[지도/목록 화면]
    ↓ 가게 선택
[길안내 실행]
```

### 3.2 권한 플로우

```
[위치 권한 요청]
    ├─ 허용 → GPS 위치 사용
    ├─ 거부 → 기본 위치(서울시청) 사용
    └─ 재요청 → 권한 설정 안내 배너
```

---

## 4. 라우팅 규칙

### 페이지 구조

| 경로 | 설명 | 주요 기능 |
|------|------|----------|
| `/` | 홈 - 테마 선택 + 룰렛 | 테마 선택, 룰렛 스핀 |
| `/map` | 지도/목록 화면 | 검색 결과, 지도, 목록 |
| `/result` | 결과 화면 | 선택 메뉴, 공유, 다시하기 |

### 딥링크 규칙

Apps in Toss 딥링크 스킴:
```
intoss://{appName}/map?theme=회식&lat=37.5665&lng=126.9780&radius=1500
```

**쿼리 파라미터**:
- `theme`: 테마 (회식, 데이트, 배달, 술집)
- `lat`: 위도 (number)
- `lng`: 경도 (number)
- `radius`: 검색 반경 (m, 기본 1500)

**주의사항**:
- 외부 브라우저 강제 오픈 제한
- 내부 WebView 흐름으로 UX 설계

---

## 5. UI/UX 가이드

### 5.1 테마 선택 화면

**레이아웃**:
```
┌─────────────────────┐
│   Roulette Meals    │
│                     │
│  ┌───────┬───────┐  │
│  │ 🍖    │ 💑    │  │
│  │ 회식  │ 데이트 │  │
│  └───────┴───────┘  │
│  ┌───────┬───────┐  │
│  │ 🍕    │ 🍺    │  │
│  │ 배달  │ 술집  │  │
│  └───────┴───────┘  │
└─────────────────────┘
```

**요구사항**:
- 4개 타일, 2x2 그리드
- 각 타일: 아이콘 + 테마명 + 짧은 설명
- 호버 효과, 클릭 피드백

### 5.2 룰렛 화면

**레이아웃**:
```
┌─────────────────────┐
│   회식 테마         │
│                     │
│    ┌───────┐        │
│    │       │        │
│    │ 룰렛  │        │
│    │       │        │
│    └───────┘        │
│                     │
│   [스핀 버튼]       │
└─────────────────────┘
```

**요구사항**:
- 룰렛 휠 중앙 배치
- 하단 고정 스핀 버튼
- 스핀 애니메이션 (ease-out)
- 햅틱 피드백
- 결과 토스트

### 5.3 지도/목록 화면

**레이아웃**:
```
┌─────────────────────┐
│ 삼겹살 주변 검색    │  ← 키워드
│ [반경: 1.5km ▼]     │  ← 필터
├─────────────────────┤
│                     │
│     [지도 영역]     │
│                     │
├─────────────────────┤
│ 가게 1 - 300m       │
│ 가게 2 - 450m       │
│ 가게 3 - 600m       │
└─────────────────────┘
```

**요구사항**:
- 상단: 검색 키워드, 반경 필터
- 중앙: 지도 (Kakao Maps)
- 하단: 가게 목록 (스크롤 가능)
- 목록 항목: 가게명, 거리, 주소, 길안내 버튼

### 5.4 오류 상태

**위치 권한 거부**:
```
┌─────────────────────┐
│ 위치 권한이 필요합니다 │
│                     │
│ 기본 위치(서울)로   │
│ 검색하시겠습니까?   │
│                     │
│ [기본 위치 사용]    │
│ [권한 설정 가기]    │
└─────────────────────┘
```

**네트워크 오류**:
```
┌─────────────────────┐
│ 검색 결과를 불러올  │
│ 수 없습니다.        │
│                     │
│ [다시 시도]         │
└─────────────────────┘
```

### 5.5 접근성 요구사항

- ✅ 키보드 포커스 표시
- ✅ 대체 텍스트 (이미지, 아이콘)
- ✅ 색상 대비 AA 이상 (4.5:1)
- ✅ 스크린 리더 지원

---

## 6. 성능 요구사항

### 6.1 로딩 시간

- **초기 로딩**: < 2초
- **페이지 전환**: < 500ms
- **지도 렌더링**: < 1초
- **검색 결과**: < 2초

### 6.2 번들 크기

- **전체 번들**: < 500KB (gzip)
- **개별 페이지**: < 200KB
- **이미지**: webp/avif, 최적화

### 6.3 메모리

- **지도 마커**: 최대 50개
- **검색 결과**: 페이지네이션 (20개/페이지)

---

## 7. 보안 및 개인정보

### 7.1 위치 정보

- ✅ 위치 권한 고지 및 동의 UX
- ✅ 수집 범위 명확히 안내
- ✅ 저장하지 않음 (메모리/세션만 사용)
- ✅ 철회 가능

### 7.2 API 키 관리

- ✅ JavaScript Key: 리퍼러 제한
- ✅ REST API Key: 서버 프록시 사용

### 7.3 HTTPS

- ✅ 전체 통신 HTTPS 강제
- ✅ CSP (Content Security Policy) 적용

---

## 8. 확장 아이디어 (향후)

### Phase 2 (선택 기능)

1. **결과 공유**
   - 이미지 캡처 및 공유
   - SNS 공유 링크

2. **즐겨찾기/차단**
   - 특정 메뉴 즐겨찾기
   - 특정 메뉴 차단 (안 나오게)
   - 로컬 저장소 사용

3. **시간대별 가중치**
   - 아침/점심/저녁 시간대별 메뉴 가중치
   - 예: 아침에는 브런치 확률 증가

4. **다국어 지원**
   - 영어, 일본어 지원
   - 메뉴 라벨 다국어 파일

### Phase 3 (고급 기능)

- AI 기반 개인화 추천
- 회원 시스템 및 히스토리
- 그룹 투표 기능
- 소셜 공유 및 초대

---

## 9. 테마별 메뉴 리스트

### 회식 테마
```json
{
  "회식": [
    "삼겹살",
    "곱창",
    "중화요리",
    "호프집",
    "전골",
    "한정식"
  ]
}
```

### 데이트 테마
```json
{
  "데이트": [
    "파스타",
    "스시",
    "브런치",
    "이자카야",
    "이탈리안",
    "퓨전"
  ]
}
```

### 배달 테마
```json
{
  "배달": [
    "치킨",
    "피자",
    "버거",
    "분식",
    "한식",
    "중식"
  ]
}
```

### 술집 테마
```json
{
  "술집": [
    "와인바",
    "칵테일",
    "펍",
    "참이슬",
    "하이볼",
    "맥주집"
  ]
}
```

---

## 10. 성공 지표 (Metrics)

### 사용자 참여

- DAU (일일 활성 사용자)
- 룰렛 스핀 횟수
- 지도 검색 사용률
- 길안내 클릭률

### 기술 지표

- 평균 로딩 시간
- 오류율 (< 1%)
- WebView 충돌률 (< 0.1%)

---

## 관련 문서

- **[기술 사양서](TECHNICAL_SPEC.md)**: 상세 기술 스택 및 아키텍처
- **[개발 가이드](DEVELOPMENT_GUIDE.md)**: 개발 규칙 및 프로세스
- **[CLAUDE.md](../CLAUDE.md)**: 프로젝트 컨텍스트 가이드

---

**작성일**: 2025-10-24
**버전**: 1.0
**작성자**: Claude Code (기반: GPT Dev-docs)
